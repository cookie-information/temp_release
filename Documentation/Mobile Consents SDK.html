<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mobile Consents SDK</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="mobile-consents-sdk">Mobile Consents SDK</h1>
<h1 id="installation">Installation</h1>
<h1 id="using-the-sdk">Using the SDK</h1>
<h2 id="initializing">Initializing</h2>
<pre class=" language-swift"><code class="prism  language-swift"><span class="token keyword">let</span> serverURL <span class="token operator">=</span> <span class="token function">URL</span><span class="token punctuation">(</span>string<span class="token punctuation">:</span> <span class="token string">"{address_of_the_server_to_send_consent}"</span><span class="token punctuation">)</span><span class="token operator">!</span>
<span class="token keyword">let</span> mobileConsentsSDK <span class="token operator">=</span> <span class="token function">MobileConsents</span><span class="token punctuation">(</span>withBaseURL<span class="token punctuation">:</span> serverURL<span class="token punctuation">)</span>
</code></pre>
<h2 id="getting-consent-solution">Getting Consent Solution</h2>
<pre class=" language-swift"><code class="prism  language-swift">mobileConsentsSDK<span class="token punctuation">.</span><span class="token function">fetchConsentSolution</span><span class="token punctuation">(</span>forUniversalConsentSolutionId<span class="token punctuation">:</span> <span class="token string">"consent solution identifier"</span><span class="token punctuation">,</span> completion<span class="token punctuation">:</span> <span class="token punctuation">{</span> result <span class="token keyword">in</span>
	<span class="token keyword">switch</span> result <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token keyword">let</span> consentSolution<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token comment">/* here you can maek use of fetched ConsentSolution object */</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span><span class="token keyword">let</span> error<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token comment">/* here you can handle error from fetching te content solution */</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> 

<span class="token comment">/* ConsentSolution object structure */</span>

<span class="token keyword">struct</span>  <span class="token builtin">ConsentSolution</span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span>  id<span class="token punctuation">:</span> <span class="token builtin">String</span>
	<span class="token keyword">let</span>  versionId<span class="token punctuation">:</span> <span class="token builtin">String</span>
	<span class="token keyword">let</span>  consentItems<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">ConsentItem</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span>  <span class="token builtin">ConsentItem</span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span>  id<span class="token punctuation">:</span> <span class="token builtin">String</span>
	<span class="token keyword">let</span>  translations<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">ConsentTranslation</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span>  <span class="token builtin">ConsentTranslation</span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span>  language<span class="token punctuation">:</span> <span class="token builtin">String</span>
	<span class="token keyword">let</span>  shortText<span class="token punctuation">:</span> <span class="token builtin">String</span>
	<span class="token keyword">let</span>  longText<span class="token punctuation">:</span> <span class="token builtin">String</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="sending-consent-to-server">Sending Consent to server</h2>
<p>If you want to send consent to the server, first you have to create <code>Consent</code> object which structure looks like this:</p>
<pre class=" language-swift"><code class="prism  language-swift"><span class="token keyword">var</span> consent <span class="token operator">=</span> <span class="token function">Consent</span><span class="token punctuation">(</span>consentSolutionId<span class="token punctuation">:</span> <span class="token string">"consentSolution.id"</span><span class="token punctuation">,</span> consentSolutionVersionId<span class="token punctuation">:</span> <span class="token string">"consentSolution.versionId"</span><span class="token punctuation">)</span>

<span class="token comment">/* if you want your consent to have a custom data you can add it as a last parametr */</span>
<span class="token keyword">let</span> customData <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"email"</span><span class="token punctuation">:</span> <span class="token string">"test@test.com"</span><span class="token punctuation">,</span> <span class="token string">"device_id"</span><span class="token punctuation">:</span> <span class="token string">"test_device_id"</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> consent <span class="token operator">=</span> <span class="token function">Consent</span><span class="token punctuation">(</span>consentSolutionId<span class="token punctuation">:</span> <span class="token string">"consentSolution.id"</span><span class="token punctuation">,</span> consentSolutionVersionId<span class="token punctuation">:</span> <span class="token string">"consentSolution.versionId"</span> customData<span class="token punctuation">:</span> customData<span class="token punctuation">)</span>

</code></pre>
<p>Then you have to add processing purposes which contains a given consents</p>
<pre class=" language-swift"><code class="prism  language-swift"><span class="token comment">/* given consents are included in main consent object as Puposes objects which you can add to Consent object using `addProcessingPurpose` function */</span>

<span class="token keyword">let</span> purpose <span class="token operator">=</span> <span class="token function">Purpose</span><span class="token punctuation">(</span>consentItemId<span class="token punctuation">:</span> <span class="token string">"consentItem.id"</span><span class="token punctuation">,</span> consentGiven<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token boolean">true</span> <span class="token operator">/</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span> language<span class="token punctuation">:</span> <span class="token string">"en"</span><span class="token punctuation">)</span>
consent<span class="token punctuation">.</span><span class="token function">addProcessingPurpose</span><span class="token punctuation">(</span>purpose<span class="token punctuation">)</span>

</code></pre>
<p>After seting up the Consent object you are ready to send it to server</p>
<pre class=" language-swift"><code class="prism  language-swift">mobileConsentsSDK<span class="token punctuation">.</span><span class="token function">postConsent</span><span class="token punctuation">(</span>consent<span class="token punctuation">)</span> <span class="token punctuation">{</span> error <span class="token keyword">in</span>
	<span class="token comment">/* if error is nil it means that post succeeded */</span>
<span class="token punctuation">}</span>
</code></pre>
</div>
</body>

</html>
